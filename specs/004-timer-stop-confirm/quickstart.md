# Quickstart: タイマー停止確認モーダル

**Feature**: 004-timer-stop-confirm
**Date**: 2026-02-22

---

## 手動テストシナリオ

### シナリオ 1: タイマー計測中に × ボタンを押す

1. ワークアウト記録画面を開く
2. ▶ ボタンを押してタイマーを開始する（`running` 状態）
3. × ボタンを押す
4. **期待値**: 「計測を停止しますか？」確認ダイアログが表示される
5. 「キャンセル」を押す
6. **期待値**: ダイアログが閉じ、タイマーは計測継続中のまま（状態変化なし）

### シナリオ 2: 確認後タイマーを停止する

1. シナリオ1の手順3まで実行
2. 「停止する」を押す
3. **期待値**:
   - タイマーが停止し、経過時間表示が「時間なし」（グレー文字）に変わる
   - × ボタンが非表示になる
   - ▶ ボタンがグレーアウトして無効化される
   - ワークアウト記録画面は維持される（ホームに戻らない）

### シナリオ 3: タイマー停止後にワークアウトを完了する

1. シナリオ2を実行してタイマーを停止する
2. 種目を追加し、セットを入力する
3. 「完了」ボタンを押す
4. **期待値**: ワークアウトサマリー画面に遷移する
5. サマリー画面の「所要時間」欄を確認
6. **期待値**: 「―」または「時間なし」が表示される（`0分` は表示されない）

### シナリオ 4: タイマー一時停止中に × ボタンを押す

1. ワークアウト記録画面を開く
2. ▶ ボタンを押してタイマーを開始する
3. ‖ ボタンを押して一時停止する（`paused` 状態）
4. × ボタンを押す
5. **期待値**: 確認ダイアログが表示される（シナリオ1と同じ）

### シナリオ 5: タイマー未開始で × ボタンを押す

1. ワークアウト記録画面を開く（タイマーは `notStarted`）
2. × ボタンを押す
3. **期待値**: 確認ダイアログが表示される
4. 「停止する」を押す
5. **期待値**: タイマーは `discarded` 状態になる（ワークアウトは継続）

---

## 単体テストで確認すべき事項

### useTimer

- `stopTimer()` を呼ぶと `timerStatus` が `'discarded'` になる
- `stopTimer()` を呼ぶと `elapsedSeconds` が `0` になる
- `stopTimer()` を呼ぶと `timerStartedAt` が `null` になる
- `running` 状態から `stopTimer()` → `discarded` に遷移する
- `paused` 状態から `stopTimer()` → `discarded` に遷移する

### RecordScreen

- × ボタン押下で `Alert.alert` が呼ばれる
- 「キャンセル」を押しても `stopTimer` が呼ばれない
- 「停止する」を押すと `stopTimer` が呼ばれる
- `session.discardWorkout()` が呼ばれない（ワークアウト継続）

### WorkoutSummaryScreen

- `timer_status = 'discarded'` のワークアウトで「―」が表示される
- `timer_status = 'completed'`（通常完了）のワークアウトで経過時間が表示される
