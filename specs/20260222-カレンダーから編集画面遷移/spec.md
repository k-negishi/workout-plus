# Feature Specification: カレンダーから編集画面遷移

**Feature Branch**: `20260222-カレンダーから編集画面遷移`
**Created**: 2026-02-22
**Status**: Draft
**Input**: CalendarStack に WorkoutEdit を追加して、カレンダータブから過去ワークアウトの編集画面へ遷移できるようにする

## 前提条件・仮定

- `HomeStack` では既に WorkoutDetail → WorkoutEdit の遷移が実装済みである
- `WorkoutDetailScreen` はカレンダータブ・ホームタブの両方で共用されている
- カレンダーから詳細画面を開いたケースでも、編集機能はホームタブと同等に提供する

## User Scenarios & Testing *(mandatory)*

### User Story 1 - カレンダーから編集画面へ遷移できる (Priority: P1)

ユーザーがカレンダータブで日付をタップし、ワークアウト詳細画面を開いた後、「編集」ボタンをタップすると編集画面へ遷移できる。

**Why this priority**: 現状では編集ボタンをタップするとアプリがエラーを表示し、編集操作が完全にブロックされている。カレンダータブからのワークアウト編集はコア機能であり、この修正なしには使えない。

**Independent Test**: カレンダータブ → 日付選択 → ワークアウト詳細 → 編集ボタンタップ の一連の操作をエラーなく完了できることで検証可能。

**Acceptance Scenarios**:

1. **Given** カレンダータブでワークアウトが記録された日付を表示している、**When** その日付をタップしてワークアウト詳細画面を開き編集ボタンをタップする、**Then** ワークアウト編集画面が表示される
2. **Given** ワークアウト編集画面が開いている、**When** 編集を完了して保存する、**Then** カレンダー画面に戻ることができる
3. **Given** ワークアウト編集画面が開いている、**When** 戻るボタンをタップする、**Then** ワークアウト詳細画面に戻る

---

### User Story 2 - 編集画面からのキャンセルが正常に動作する (Priority: P2)

ユーザーがカレンダー経由で編集画面を開いた後、変更を加えずにキャンセルした場合に詳細画面へ戻れる。

**Why this priority**: 編集をキャンセルする操作はユーザーが頻繁に行う。戻り先がカレンダー文脈でも正常に機能することが必要。

**Independent Test**: 編集画面でキャンセルボタンタップ後、ワークアウト詳細画面が表示されることで検証可能。

**Acceptance Scenarios**:

1. **Given** カレンダー経由でワークアウト編集画面を開いている、**When** 変更なしでキャンセルボタンをタップする、**Then** ワークアウト詳細画面に戻る
2. **Given** カレンダー経由でワークアウト編集画面を開いており変更を加えた、**When** キャンセルボタンをタップする、**Then** 変更破棄の確認ダイアログが表示される

---

### Edge Cases

- カレンダータブで編集画面を開いている最中に別タブへ切り替えた場合、戻ったときにスタックが保持されている
- 存在しない workoutId で編集画面を開こうとした場合、エラーメッセージを表示して詳細画面へ戻る

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: カレンダータブのナビゲーション構造が WorkoutEdit 画面への遷移をサポートしなければならない
- **FR-002**: カレンダー経由で開いた WorkoutDetail 画面の編集ボタンが、エラーなく WorkoutEdit 画面へ遷移できなければならない
- **FR-003**: WorkoutEdit 画面の保存・キャンセル操作が、カレンダー文脈（遷移元が CalendarStack）でも正常に動作しなければならない
- **FR-004**: ホームタブ経由の編集機能（既存）に影響を与えてはならない

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: カレンダータブから編集画面を開く操作がエラーなく完了する（現在は 100% エラー → 0% エラー）
- **SC-002**: ホームタブ経由での既存の編集フローが引き続き正常に動作する（デグレなし）
- **SC-003**: カレンダー → 詳細 → 編集 → 保存 → 詳細画面へ戻る、の一連のフローが 5 タップ以内で完了できる
