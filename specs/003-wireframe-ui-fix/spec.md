# 機能仕様書: ワイヤーフレーム完全準拠 UI 修正

**フィーチャーブランチ**: `003-wireframe-ui-fix`
**作成日**: 2026-02-22
**ステータス**: Draft
**入力**: ホーム・カレンダー・記録画面の実装をワイヤーフレーム HTML に完全準拠させ、初期シードデータを追加する

---

## 背景

実機（iPhone 16 Pro / iOS 18.6）でアプリを起動した際、以下の問題が確認された。

1. **ホーム画面がほぼ空白**
   ワークアウトデータが 0 件のため EmptyState のみ表示。StreakCard・WeeklyGoals・最近のワークアウトが一切見えない。
2. **+ボタンが消えている**
   タブバーの中央カスタムボタンが overflow clipping で非表示になっている。
3. **StreakCard の設計が誤っている**
   ワイヤーフレーム HTML には曜日ラベル（月〜日）と完了日のチェックマークが存在するが、現実装は両方を削除している。
4. **カレンダーに訓練日インジケーターなし**
   データがないため確認できないが、訓練日の背景色スタイルも要確認。

**修正方針**: ワイヤーフレーム HTML（`requirements/adopted/workout_plus_wireframes_v5_md3.html`）を「正」とし、その CSS/HTML 構造に準拠した実装に修正する。同時に 2/1 のシードデータを追加して動作確認を可能にする。

---

## ユーザーシナリオ & テスト *(必須)*

### ユーザーストーリー 1 — タブバーの+ボタンが正しく表示・動作する (優先度: P1)

ユーザーがアプリを起動した時、タブバーの中央に青い円形の+ボタンが浮き出た状態で完全に表示され、タップするとワークアウト記録画面が開く。

**この優先度の理由**: +ボタンはアプリのコア機能（ワークアウト記録）へのエントリーポイント。これが見えない・押せない状態ではアプリとして機能しない。

**独立テスト**: アプリを起動してホーム画面のタブバーを確認するだけで検証可能。

**受け入れシナリオ**:

1. **Given** アプリが起動している、**When** タブバーを確認する、**Then** 中央の+ボタン（56×56px 青円形）がタブバーから上に浮き出た状態で完全に表示されており、切れていない
2. **Given** +ボタンが表示されている、**When** +ボタンをタップする、**Then** ワークアウト記録画面が開く
3. **Given** +ボタンが表示されている、**When** ボタン周囲を確認する、**Then** 青いドロップシャドウ（box-shadow）が表示されている

---

### ユーザーストーリー 2 — ホーム画面がワイヤーフレームのレイアウトで表示される (優先度: P1)

ユーザーがホームタブを開いた時、データの有無に関わらず StreakCard が表示され、データがある場合は WeeklyGoals セクションと最近のワークアウトカードも表示される。

**この優先度の理由**: ホームはアプリの顔。StreakCard が常に表示されることで「今月の積み上げ」が視覚化され、継続モチベーションに直結する。

**独立テスト**: シードデータを追加した後にホーム画面を開いて確認。

**受け入れシナリオ**:

1. **Given** ホーム画面を表示する、**When** StreakCard を確認する、**Then** 今月のトレーニング日数（大きな数値）+ 炎アイコン + 今週 7 日分の円インジケーター（完了日: 青背景+チェックマーク、休息日: 薄青）+ 各日の曜日ラベル（月〜日）が表示される
2. **Given** ワークアウトが 1 件以上ある、**When** ホーム画面を確認する、**Then** 「今週の目標」セクション（3カラムグリッド: ワークアウト数・総負荷量・達成率 + 週間進捗バー）が表示される
3. **Given** ワークアウトが 1 件以上ある、**When** 最近のワークアウトセクションを確認する、**Then** 各カードに種目アイコン（カラー背景）・ワークアウト名・完了バッジ・セット数・ボリューム・時間タグが表示される
4. **Given** ワークアウトが 0 件、**When** ホーム画面を表示する、**Then** StreakCard（今月 0 日）・WeeklyGoals・「最近のワークアウト」セクションヘッダーが表示され、カードは表示されない（絵文字 EmptyState は表示しない）

---

### ユーザーストーリー 3 — カレンダー画面の訓練日が視覚的に区別できる (優先度: P2)

ユーザーがカレンダータブを開いた時、トレーニングを実施した日付が背景色付きで一目でわかり、今日の日付は青い塗りつぶしで強調表示される。

**この優先度の理由**: カレンダーはトレーニング記録の振り返り機能。視覚的な差異がないとどの日にトレーニングしたかが分からない。

**独立テスト**: シードデータ（2/1）追加後にカレンダー画面で 2 月を確認。

**受け入れシナリオ**:

1. **Given** トレーニングのある日付（例: 2/1）がある、**When** カレンダーを確認する、**Then** その日付セルは薄い青背景（#E6F2FF）で表示される
2. **Given** カレンダーを表示する、**When** 今日の日付を確認する、**Then** 今日は青い塗りつぶし（#4D94FF）+ 白文字で表示される
3. **Given** トレーニングのある日付を選択する、**When** 日付をタップする、**Then** 下部に当日のワークアウトサマリー（時間・ボリューム・種目数・セット数）が表示される

---

### ユーザーストーリー 4 — 記録画面の種目ブロックが視覚的に分離されている (優先度: P2)

ユーザーがワークアウトを記録する時、種目ごとのブロックが下ボーダーで明確に区切られており、各種目に筋肉グループ・器具の情報が表示される。

**この優先度の理由**: 複数種目を記録する際に区切りが曖昧だと操作ミスが起きやすい。

**独立テスト**: 記録画面で種目を 2 種目追加して確認。

**受け入れシナリオ**:

1. **Given** 記録中の種目が 2 件以上ある、**When** 種目ブロック間を確認する、**Then** 各ブロック下部に 8px のグレーボーダー（#F1F3F5）が表示されている
2. **Given** 種目ブロックを確認する、**When** 種目名の下を確認する、**Then** 筋肉グループ名・器具名がグレーテキストで表示されている

---

### ユーザーストーリー 5 — 初期シードデータで全画面の動作確認ができる (優先度: P1)

開発者（自分）が 2/1 のシードデータを投入することで、ホーム・カレンダー・記録フロー全ての画面を実データで確認できる。

**この優先度の理由**: データゼロ状態では UI が EmptyState しか表示されないため、他の修正内容が正しいかどうかを確認できない。

**独立テスト**: シードデータ追加後にアプリを再起動し、ホーム・カレンダーを確認。

**受け入れシナリオ**:

1. **Given** アプリを起動する、**When** ホーム画面を確認する、**Then** 2 月 1 日のワークアウト（ベンチプレス + インクラインチェストプレス）が最近のトレーニングに表示される
2. **Given** カレンダーを確認する、**When** 2 月 1 日のセルを確認する、**Then** 訓練日の背景色スタイルが確認できる

---

### エッジケース

- ワークアウトが 0 件でも画面レイアウトは変わらない（StreakCard: 今月0日、最近のワークアウト: カードなし）。EmptyState（絵文字・誘導テキスト）はワイヤーフレームに存在しないため実装しない
- 今日がトレーニング日で完了済みの場合、StreakCard の今日の円はチェックマーク付き青塗りになる
- 今日がまだトレーニングしていない場合、今日の円は青ボーダーのみ（塗りなし）で強調される
- シードデータは開発用途のみ。ユーザーが削除できること

---

## 要件 *(必須)*

### 機能要件

**タブバー**

- **FR-001**: タブバーのコンテナは `overflow: visible` を持ち、中央の+ボタンがタブバー上部に飛び出した状態で完全に表示されなければならない
- **FR-002**: +ボタンは青いドロップシャドウ（`0 4px 16px rgba(77,148,255,0.4)`）を持たなければならない

**StreakCard**

- **FR-003**: StreakCard は今週 7 日分の円インジケーターを表示しなければならない
  - 完了日: 青背景（#4D94FF）+ 白チェックマーク SVG（14×14px）
  - 休息日: 薄い青背景（`rgba(77,148,255,0.10)`）
  - 今日（未完了）: 青ボーダーのみ
- **FR-004**: 各円インジケーターの下に曜日ラベル（月・火・水・木・金・土・日）を表示しなければならない
- **FR-005**: StreakCard はワークアウトが 0 件の場合でも表示されなければならない（EmptyState と共存）

**ホーム画面 WeeklyGoals**

- **FR-006**: ワークアウトが 1 件以上ある場合、「今週の目標」セクションを表示しなければならない
  - 3カラムグリッド: 今週のワークアウト数・総負荷量（t換算）・達成率（%）
  - 各セルは値・ラベル・前週比変化を表示
  - プログレスバー（達成率%で幅が変化）

**ホーム画面 RecentWorkoutCard**

- **FR-007**: 最近のワークアウトカードは以下を表示しなければならない
  - 種目アイコン（40×40px カラー背景円形）
  - ワークアウト名（「胸・三頭トレーニング」形式）または日付（名前がない場合）
  - 「完了」バッジ
  - セット数・ボリューム・時間タグ

**カレンダー画面**

- **FR-008**: トレーニングのある日付セルは薄い青背景（`colors.primaryBg` = `#E6F2FF`）を表示しなければならない
- **FR-009**: 今日の日付セルはプライマリ青背景（`colors.primary` = `#4D94FF`）+ 白文字で表示されなければならない

**記録画面**

- **FR-010**: 各種目ブロックの下部に 8px のグレーボーダー（`colors.surfaceVariant` = `#F1F3F5`）が表示されなければならない
- **FR-011**: 種目名の下に筋肉グループ名・器具名をグレーテキストで表示しなければならない

**初期シードデータ**

- **FR-012**: 開発環境では 2026/2/1 のワークアウト（ベンチプレス 3セット + インクラインチェストプレス 3セット）がデータベースに存在しなければならない

### 主要エンティティ

既存のデータモデル（`specs/001-workout-core-screens/data-model.md`）を変更しない。本フィーチャーはビジュアル層の修正と開発用シードデータの追加のみ。

---

## 成功基準 *(必須)*

### 測定可能な成果

- **SC-001**: アプリを起動したとき、タブバー中央の+ボタンが切れることなく完全に表示される（目視確認 100% 再現）
- **SC-002**: シードデータ投入後、ホーム画面に StreakCard・WeeklyGoals・最近のワークアウトカードの 3 セクションが全て表示される
- **SC-003**: カレンダーで 2/1（シードデータの日付）のセルに訓練日スタイル（薄青背景）が適用されている
- **SC-004**: ワイヤーフレーム HTML をブラウザで開いた状態とアプリを並べて比較し、ホーム・カレンダー・記録画面の主要 UI 要素が 95% 以上一致している

---

## テスト方針

- 各変更コンポーネントに対してコンポーネント単体テストを実装する
- テストは「要素の存在確認・props の反映・条件分岐」のみ検証（スナップショット不使用）
- シードデータは DB 操作のテストとは分離し、開発用スクリプトまたは初回起動時の条件分岐で投入する

---

## 前提条件

- ワイヤーフレーム HTML（`requirements/adopted/workout_plus_wireframes_v5_md3.html`）を「正」とする
- ブラウザで HTML を開いた際の実際の表示が実装の正解。CSS 変数・Google Fonts CDN が適用された状態が基準
- カラーは `apps/mobile/src/shared/constants/colors.ts` の定数を使用。ハードコード禁止
- 既存のデータ取得・ストア・DB・ナビゲーション構造は変更しない
- Expo Go で動作確認（ネイティブモジュール追加不可）

---

## ワイヤーフレーム参照

| 画面 | ファイル | 行範囲 |
|------|----------|--------|
| タブバー CSS | wireframes_v5_md3.html | L280〜L358 |
| StreakCard CSS | wireframes_v5_md3.html | L397〜L485 |
| ホーム画面 HTML | wireframes_v5_md3.html | L2903〜L3127 |
| カレンダー画面 HTML | wireframes_v5_md3.html | L3817〜L3923 |
| 記録画面 HTML | wireframes_v5_md3.html | L3128〜L3361 |
