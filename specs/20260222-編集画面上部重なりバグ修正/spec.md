# Feature Specification: 編集画面上部重なりバグ修正

**Feature Branch**: `20260222-編集画面上部重なりバグ修正`
**Created**: 2026-02-22
**Status**: Draft
**Input**: User description: "https://github.com/k-negishi/workout-plus/issues/117 — 編集画面の上部が被っている"

## 前提条件・仮定

- 対象画面はワークアウト編集画面（WorkoutEditScreen）
- ナビゲーションスタックはシステムヘッダーを非表示（headerShown: false）で動作している
- 他の画面（RecordScreen, WorkoutDetailScreen, WorkoutSummaryScreen）はすでに useSafeAreaInsets でトップインセットを正しく処理している
- デバイスの安全領域（ノッチ・ダイナミックアイランド・ステータスバー）の高さはデバイスによって異なる

---

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 編集画面が正しく表示される (Priority: P1)

ユーザーがワークアウト詳細画面から「編集」ボタンをタップして編集画面に遷移したとき、
ヘッダー（「キャンセル」「編集」「保存」）がステータスバーやノッチに重なることなく、
正しい位置に表示される。

**Why this priority**: UIの基本的な視認性・操作性に直接影響するため。ヘッダーが被っていると
「キャンセル」「保存」ボタンが押しにくい・見えにくいという致命的なUX問題となる。

**Independent Test**: ノッチ付きデバイス（iPhone X 以降）またはシミュレーターで
編集画面を開き、ヘッダーがステータスバーと重ならずに表示されることを確認できる。

**Acceptance Scenarios**:

1. **Given** ノッチ付きデバイスでワークアウト詳細画面を表示している, **When** 「編集」ボタンをタップして編集画面に遷移する, **Then** ヘッダーがステータスバー・ノッチの下に正しく配置され、重なりが発生しない
2. **Given** ノッチなしデバイス（iPhone SE 等）でワークアウト詳細画面を表示している, **When** 「編集」ボタンをタップして編集画面に遷移する, **Then** ヘッダーが画面最上部から適切な位置に表示される（余分な余白が生じない）
3. **Given** ホームタブ経由・カレンダータブ経由いずれのルートでも, **When** 編集画面に遷移する, **Then** ヘッダーの重なりバグが発生しない

---

### Edge Cases

- ダイナミックアイランド搭載デバイス（iPhone 14 Pro以降）での表示確認
- デバイスの向き変更時にヘッダー位置が正しく更新される
- 固定値パディング（`pt-10` 相当の静的値）を使ってはならない

---

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 編集画面のカスタムヘッダーは、デバイスの安全領域トップインセットを動的に取得して上部パディングに適用しなければならない
- **FR-002**: ヘッダーの表示位置は、ステータスバー・ノッチ・ダイナミックアイランドと重ならない位置でなければならない
- **FR-003**: 安全領域の適用は固定値ではなく、デバイスの実際のインセット値に基づいて行われなければならない
- **FR-004**: ホームタブ経由・カレンダータブ経由のいずれの遷移ルートでも同一の修正が適用されなければならない
- **FR-005**: 修正後も「キャンセル」「保存」ボタンの機能（タップ応答）が正常に動作しなければならない

---

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: ノッチ付きデバイス（実機またはシミュレーター）で編集画面を開いたとき、ヘッダーとステータスバーの重なりが視覚的にゼロである
- **SC-002**: ノッチなしデバイスで編集画面を開いたとき、余分な上部余白が生じない（他の画面と見た目の一貫性がある）
- **SC-003**: 「キャンセル」「保存」ボタンがタップ領域を完全に確保しており、ユーザーが正確に操作できる
- **SC-004**: ホームタブ・カレンダータブ双方から遷移した際、すべてのデバイスタイプで重なりバグが再現しない
