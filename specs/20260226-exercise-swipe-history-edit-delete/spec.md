# æ©Ÿèƒ½ä»•æ§˜æ›¸: ç¨®ç›®é¸æŠç”»é¢ã‚¹ãƒ¯ã‚¤ãƒ—å±¥æ­´é·ç§» + å±¥æ­´ç”»é¢ã‚«ã‚¹ã‚¿ãƒ ç¨®ç›®ç·¨é›†ãƒ»å‰Šé™¤

**Feature ID:** 20260226-exercise-swipe-history-edit-delete
**GitHub Issue:** #155
**ä½œæˆæ—¥:** 2026-02-26
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:** Draft

---

## æ¦‚è¦

ç¨®ç›®é¸æŠç”»é¢ï¼ˆExercisePickerScreenï¼‰ã«å·¦ã‚¹ãƒ¯ã‚¤ãƒ—ã§ã€Œå±¥æ­´ã€ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã—ã€
ç¨®ç›®å±¥æ­´ç”»é¢ï¼ˆExerciseHistoryFullScreenï¼‰ã§ã‚«ã‚¹ã‚¿ãƒ ç¨®ç›®ã®ç·¨é›†ãƒ»è«–ç†å‰Šé™¤ã‚’å¯èƒ½ã«ã™ã‚‹ã€‚
ä½µã›ã¦ã€exercises ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã® `is_deleted` ã‚«ãƒ©ãƒ è¿½åŠ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã€
ExercisePicker æ—¢å­˜ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã®å‰Šé™¤ã‚’è¡Œã†ã€‚

---

## ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

### US-01: ã‚¹ãƒ¯ã‚¤ãƒ—ã§å±¥æ­´ã‚’ç¢ºèªã™ã‚‹
> ãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¦ãƒˆç™»éŒ²ä¸­ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç¨®ç›®è¡Œã‚’å·¦ã‚¹ãƒ¯ã‚¤ãƒ—ã™ã‚‹ã¨ã€Œå±¥æ­´ã€ãƒœã‚¿ãƒ³ãŒç¾ã‚Œã€
> ã‚¿ãƒƒãƒ—ã§ç¨®ç›®å±¥æ­´ç”»é¢ã«é·ç§»ã§ãã‚‹ã€‚è¡Œã‚¿ãƒƒãƒ—ã«ã‚ˆã‚‹ç¨®ç›®é¸æŠã¯å¤‰ã‚ã‚‰ãªã„ã€‚

**å—ã‘å…¥ã‚Œæ¡ä»¶:**
- [ ] ç¨®ç›®è¡Œã‚’å·¦ã‚¹ãƒ¯ã‚¤ãƒ—ã™ã‚‹ã¨å³ç«¯ã«ã€Œå±¥æ­´ã€ãƒœã‚¿ãƒ³ï¼ˆ72pxå¹…ã€èƒŒæ™¯#E6F2FFã€ãƒ†ã‚­ã‚¹ãƒˆ#4D94FFï¼‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã€Œå±¥æ­´ã€ãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ—ã§ ExerciseHistoryFullScreen ã«é·ç§»ã™ã‚‹
- [ ] è¡Œã‚¿ãƒƒãƒ—ã«ã‚ˆã‚‹ç¨®ç›®é¸æŠï¼ˆsingle/multi ä¸¡ãƒ¢ãƒ¼ãƒ‰ï¼‰ã¯å¤‰æ›´ãªã—
- [ ] ã‚¹ãƒ¯ã‚¤ãƒ—æˆ»ã— or ä»–ã®è¡Œã‚¿ãƒƒãƒ—ã§ã‚¹ãƒ¯ã‚¤ãƒ—ãŒé–‰ã˜ã‚‹

### US-02: å±¥æ­´ç”»é¢ã§ã‚«ã‚¹ã‚¿ãƒ ç¨®ç›®ã‚’ç·¨é›†ã™ã‚‹
> è‡ªåˆ†ã§ä½œæˆã—ãŸã‚«ã‚¹ã‚¿ãƒ ç¨®ç›®ã®å±¥æ­´ç”»é¢ã§ã€ç¨®ç›®åãƒ»éƒ¨ä½ãƒ»å™¨å…·ã‚’ç·¨é›†ãƒ»ä¿å­˜ã§ãã‚‹ã€‚

**å—ã‘å…¥ã‚Œæ¡ä»¶:**
- [ ] ã‚«ã‚¹ã‚¿ãƒ ç¨®ç›®ã®å±¥æ­´ç”»é¢ã«ã®ã¿ âœ ã‚¢ã‚¤ã‚³ãƒ³ãŒãƒ˜ãƒƒãƒ€ãƒ¼å³ä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] âœ ã‚¿ãƒƒãƒ—ã§ãƒ˜ãƒƒãƒ€ãƒ¼ä¸‹ã«ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆåå‰ãƒ»éƒ¨ä½ãƒ»å™¨å…·ï¼‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã€Œä¿å­˜ã€ã§ `ExerciseRepository.update()` ã‚’å‘¼ã³ã€ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‰ã˜ã¦ãƒ˜ãƒƒãƒ€ãƒ¼ç¨®ç›®åã‚’æ›´æ–°ã™ã‚‹
- [ ] ãƒ—ãƒªã‚»ãƒƒãƒˆç¨®ç›®ã«ã¯ âœ ã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œãªã„

### US-03: å±¥æ­´ç”»é¢ã§ã‚«ã‚¹ã‚¿ãƒ ç¨®ç›®ã‚’å‰Šé™¤ã™ã‚‹
> è‡ªåˆ†ã§ä½œæˆã—ãŸã‚«ã‚¹ã‚¿ãƒ ç¨®ç›®ã‚’å‰Šé™¤ã§ãã€ä»¥å¾Œã®ç¨®ç›®é¸æŠãƒªã‚¹ãƒˆã‹ã‚‰æ¶ˆãˆã‚‹ã€‚
> éå»ã®ãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¦ãƒˆè¨˜éŒ²ã¯æ®‹ã‚‹ã€‚

**å—ã‘å…¥ã‚Œæ¡ä»¶:**
- [ ] ã‚«ã‚¹ã‚¿ãƒ ç¨®ç›®ã®å±¥æ­´ç”»é¢ã«ã®ã¿ ğŸ—‘ ã‚¢ã‚¤ã‚³ãƒ³ãŒãƒ˜ãƒƒãƒ€ãƒ¼å³ä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ğŸ—‘ ã‚¿ãƒƒãƒ—ã§ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼ˆAlert.alertï¼‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹
  - ã‚¿ã‚¤ãƒˆãƒ«: ã€Œ{ç¨®ç›®å}ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã€
  - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ã€Œå‰Šé™¤å¾Œã‚‚éå»ã®ãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¦ãƒˆè¨˜éŒ²ã¯æ®‹ã‚Šã¾ã™ã€‚ã€
  - ãƒœã‚¿ãƒ³: [ã‚­ãƒ£ãƒ³ã‚»ãƒ«] [å‰Šé™¤]
- [ ] ã€Œå‰Šé™¤ã€ã‚¿ãƒƒãƒ—ã§ `ExerciseRepository.softDelete(id)` â†’ `navigation.goBack()`
- [ ] ç¨®ç›®é¸æŠç”»é¢ã«æˆ»ã‚‹ã¨ `loadExercises()` ãŒå†å®Ÿè¡Œã•ã‚Œãƒªã‚¹ãƒˆã‹ã‚‰æ¶ˆãˆã¦ã„ã‚‹
- [ ] ãƒ—ãƒªã‚»ãƒƒãƒˆç¨®ç›®ã«ã¯ ğŸ—‘ ã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œãªã„

### US-04: DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§è«–ç†å‰Šé™¤ãƒ•ãƒ©ã‚°ã‚’è¿½åŠ ã™ã‚‹
> `exercises` ãƒ†ãƒ¼ãƒ–ãƒ«ã« `is_deleted` ã‚«ãƒ©ãƒ ï¼ˆINTEGER 0|1ï¼‰ã‚’è¿½åŠ ã—ã€
> å…¨ã¦ã®å–å¾—ã‚¯ã‚¨ãƒªã‹ã‚‰å‰Šé™¤æ¸ˆã¿ç¨®ç›®ã‚’é™¤å¤–ã™ã‚‹ã€‚

**å—ã‘å…¥ã‚Œæ¡ä»¶:**
- [ ] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ v7 ã§ `is_deleted INTEGER NOT NULL DEFAULT 0` ãŒè¿½åŠ ã•ã‚Œã‚‹
- [ ] `findAll`, `findByCategory`, `findFavorites`, `findCustom`, `search` ã« `WHERE is_deleted = 0` ãŒè¿½åŠ ã•ã‚Œã‚‹
- [ ] `softDelete(id: string): Promise<void>` ãŒå®Ÿè£…ã•ã‚Œã‚‹ï¼ˆ`is_deleted = 1` ã«æ›´æ–°ï¼‰
- [ ] `restore(id: string): Promise<void>` ãŒå®Ÿè£…ã•ã‚Œã‚‹ï¼ˆ`is_deleted = 0` ã«æ›´æ–°ã€UI ã¯å°†æ¥å¯¾å¿œï¼‰

### US-05: ExercisePicker ã®æ—¢å­˜ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç·¨é›†ã‚’å‰Šé™¤ã™ã‚‹
> ç·¨é›†æ©Ÿèƒ½ã‚’å±¥æ­´ç”»é¢ã«é›†ç´„ã™ã‚‹ãŸã‚ã€ExercisePickerScreen ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã‚’å‰Šé™¤ã™ã‚‹ã€‚

**å—ã‘å…¥ã‚Œæ¡ä»¶:**
- [ ] `handleStartEdit` / `handleSaveEdit` é–¢æ•°ãŒå‰Šé™¤ã•ã‚Œã‚‹
- [ ] `InlineEditForm` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŠã‚ˆã³é–¢é€£ state ãŒå‰Šé™¤ã•ã‚Œã‚‹
- [ ] ç¨®ç›®è¡Œã«ã€Œç·¨é›†ã€ãƒœã‚¿ãƒ³ãƒ»ã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œãªããªã‚‹
- [ ] å‰Šé™¤å¾Œã‚‚ Lint / TypeScript ã‚¨ãƒ©ãƒ¼ãŒãªã„

---

## æŠ€è¡“ä»•æ§˜

### é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | å¤‰æ›´ç¨®åˆ¥ | æ¦‚è¦ |
|---------|---------|------|
| `apps/mobile/src/database/schema.ts` | å¤‰æ›´ | `is_deleted` ã‚«ãƒ©ãƒ å®šç¾©è¿½åŠ  |
| `apps/mobile/src/database/migrations.ts` | å¤‰æ›´ | v7 ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¿½åŠ  |
| `apps/mobile/src/database/types.ts` | å¤‰æ›´ | `ExerciseRow` ã« `is_deleted: 0 \| 1` è¿½åŠ  |
| `apps/mobile/src/types/exercise.ts` | å¤‰æ›´ | `Exercise` å‹ã« `isDeleted: boolean` è¿½åŠ  |
| `apps/mobile/src/database/repositories/exercise.ts` | å¤‰æ›´ | `softDelete`, `restore` è¿½åŠ ã€å…¨ find* ã« `is_deleted = 0` ãƒ•ã‚£ãƒ«ã‚¿è¿½åŠ  |
| `apps/mobile/src/features/exercise/screens/ExercisePickerScreen.tsx` | å¤‰æ›´ | ã‚¹ãƒ¯ã‚¤ãƒ—æ©Ÿèƒ½è¿½åŠ ã€ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç·¨é›†å‰Šé™¤ |
| `apps/mobile/src/features/exercise/screens/ExerciseHistoryFullScreen.tsx` | å¤‰æ›´ | ç·¨é›†ãƒ»å‰Šé™¤UIè¿½åŠ  |

### ã‚¹ãƒ¯ã‚¤ãƒ—å®Ÿè£…æ–¹é‡

- `react-native-gesture-handler` ã® `Swipeable` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ï¼ˆæ—¢å­˜ä¾å­˜ `~2.28.0`ï¼‰
- `renderRightActions` prop ã§ã‚¹ãƒ¯ã‚¤ãƒ—ãƒœã‚¿ãƒ³ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
- ã‚¹ãƒ¯ã‚¤ãƒ—å‚ç…§ï¼ˆ`swipeableRef`ï¼‰ã‚’å„è¡Œã§ç®¡ç†ã—ã€ä»–ã®è¡Œã‚¿ãƒƒãƒ—æ™‚ã«ã‚¯ãƒ­ãƒ¼ã‚º

### ExerciseRow å‹å¤‰æ›´

```typescript
// database/types.ts
export type ExerciseRow = {
  // ... æ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  is_deleted: 0 | 1; // è¿½åŠ 
};
```

### Exercise å‹å¤‰æ›´

```typescript
// types/exercise.ts
export type Exercise = {
  // ... æ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  isDeleted: boolean; // è¿½åŠ 
};
```

### Repository æ–°è¦ãƒ¡ã‚½ãƒƒãƒ‰

```typescript
// ExerciseRepository
async softDelete(id: string): Promise<void>
async restore(id: string): Promise<void>
```

### DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

```sql
-- v6 â†’ v7
ALTER TABLE exercises ADD COLUMN is_deleted INTEGER NOT NULL DEFAULT 0;
```

---

## ã‚¹ã‚³ãƒ¼ãƒ—å¤–

- å‰Šé™¤æ¸ˆã¿ç¨®ç›®ã®ä¸€è¦§ãƒ»å¾©å…ƒ UIï¼ˆ`restore()` ãƒ¡ã‚½ãƒƒãƒ‰ã®ã¿å®Ÿè£…ï¼‰
- ãƒ—ãƒªã‚»ãƒƒãƒˆç¨®ç›®ã®ç·¨é›†ãƒ»å‰Šé™¤
- å‰Šé™¤æ¸ˆã¿ç¨®ç›®ã®ãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¦ãƒˆè¨˜éŒ²ã¸ã®å½±éŸ¿ç¢ºèª UI

---

## ä¾å­˜é–¢ä¿‚

- `react-native-gesture-handler ~2.28.0`ï¼ˆæ—¢å­˜ä¾å­˜ï¼‰
- `expo-sqlite ~15.2.0`ï¼ˆæ—¢å­˜ä¾å­˜ï¼‰
- DB ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ v6ï¼ˆç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰

---

## ãƒ†ã‚¹ãƒˆæ–¹é‡

| ãƒ†ã‚¹ãƒˆå¯¾è±¡ | ãƒ†ã‚¹ãƒˆç¨®åˆ¥ | ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ |
|-----------|----------|------------|
| `ExerciseRepository.softDelete` | å˜ä½“ãƒ†ã‚¹ãƒˆ | å¯¾è±¡è¡Œã® `is_deleted = 1` ã«ãªã‚‹ã“ã¨ |
| `ExerciseRepository.restore` | å˜ä½“ãƒ†ã‚¹ãƒˆ | å¯¾è±¡è¡Œã® `is_deleted = 0` ã«ãªã‚‹ã“ã¨ |
| `ExerciseRepository.findAll` | å˜ä½“ãƒ†ã‚¹ãƒˆ | `is_deleted = 1` ã®è¡ŒãŒé™¤å¤–ã•ã‚Œã‚‹ã“ã¨ |
| `ExerciseRepository.findAll` | å˜ä½“ãƒ†ã‚¹ãƒˆ | `is_deleted = 0` ã®è¡Œã¯å«ã¾ã‚Œã‚‹ã“ã¨ |
| ã‚¹ãƒ¯ã‚¤ãƒ—UI | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ | ã‚¹ãƒ¯ã‚¤ãƒ—å¾Œã«ã€Œå±¥æ­´ã€ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ |
| å‰Šé™¤ãƒ•ãƒ­ãƒ¼ | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ | ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹ |
